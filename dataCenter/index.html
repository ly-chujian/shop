<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>后台管理系统</title>
    <link href="/app.css" type="text/css" rel="stylesheet" />
    <link href="/resource/css/bootstrap.css" type="text/css" rel="stylesheet" />
    <script src="/core/tools/keyMap.js"></script>
    <script src="/core/tools/event.js"></script>
    <script src="/core/tools/processPerformance.js"></script>
    <script src="/core/tools/cache.js"></script>
    <script src="/core/tools/baseToolV1.js"></script>
    <script src="/core/tools/customEvent.js"></script>
    <script src="/core/tools/taskQueue.js"></script>
    <script src="/core/tools/throttle.js"></script>
</head>
<body>
    <div id="example"></div>
    <input type="button" value="测试Object自定义事件" id="btn1" />
    <input type="button" value="测试DOM自定义事件" id="btn2" />

    <input type="text" id="t1" />
    <input type="text" id="t2" />
    <input type="text" id="t3" />
</body>
</html>
<script>
    var a = [{name:1},{name:2},{name:3},{name:4},{name:5},{name:6}];

    var b = a.filter(function(item,index,array){
        return item.name > 3;
    })

    var c = a.reduce(function(prev,next,index,array){
        var tmp = prev;
        if(prev instanceof Object){
            tmp = prev.name;
        }
        return tmp + next.name;
    })

    function Subject(id) {
        this._observerArr = [];
        this.registerObserver=function(observer){
            this._observerArr.push(observer);
            observer._attach(this);
        }
        this.removeObserver=function(observer) {}

        this.getValue = function(){
            return document.querySelector("#"+id).value;
        }

        this.notify = function(){
            for(var index = 0; index<this._observerArr.length; index++){
                this._observerArr[index].update(this);
            }
        }
    }

    function Observer(id) {
        this._subjects=[];
        this._attach = function(subject) {
            this._subjects.push(subject);
        }
        this.update = function() {
            var value = 0;
            for(var index = 0;index<this._subjects.length;index++){
                var tmp = this._subjects[index].getValue();
                value += parseInt(tmp?tmp:0);
            }
            document.querySelector("#"+id).value = value;
        }
    }

    var subjectT1 = new Subject('t1');
    var subjectT2 = new Subject('t2');

    var observer = new Observer('t3');
    subjectT1.registerObserver(observer);
    subjectT2.registerObserver(observer);

    document.getElementById("t1").addEventListener("blur",function(){
        subjectT1.notify();
    },false);
    document.getElementById("t2").addEventListener("blur",function(){
        subjectT2.notify();
    },false);

    function rank(arr){
        var r = arr.map(function(item){
            return {
                data:item,
                ran:Math.random()
            }
        })
        return r.sort(function(a,b){
            return a.ran - b.ran;
        }).map(function(item){
            return item.data;
        })
    }

    var arr =  [6, 12, 19, 4];
    console.log(rank(arr));

</script>
<script src="/build/bundle.js"></script>
